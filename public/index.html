<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Clanner</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="glass">
    <h1>CLANNER</h1>
    <p>ĞŸĞ¾Ñ‡Ğ½Ñ–Ñ‚ÑŒ Ñ€Ğ¾Ğ·Ğ¼Ğ¾Ğ²Ñƒ Ğ· Ğ±Ğ¾Ñ‚Ğ¾Ğ¼ <b>@Clanner_bot</b></p>

    <div class="stats">
        ğŸ‘¥ <span id="total">0</span> |
        ğŸŸ¢ <span id="online">0</span>
    </div>

    <div class="buttons">
        <button onclick="play()">ğŸ® Ğ“Ñ€Ğ°Ñ‚Ğ¸</button>
        <button onclick="leaderboard()">ğŸ† Ğ›Ñ–Ğ´ĞµÑ€Ğ±Ğ¾Ñ€Ğ´</button>
    </div>

    <div id="output"></div>
</div>

<script>
let tgId = prompt("Ğ’Ğ²ĞµĞ´Ğ¸ ÑĞ²Ñ–Ğ¹ Telegram ID:");

const ws = new WebSocket(location.origin.replace(/^http/, "ws"));
ws.onmessage = (event) => {
    const data = JSON.parse(event.data);
    document.getElementById("online").innerText = data.online;
};

async function loadStats() {
    const res = await fetch("/api/stats");
    const data = await res.json();
    document.getElementById("total").innerText = data.total;
}
loadStats();
setInterval(loadStats, 5000);

async function play() {
    const res = await fetch("/api/play", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ tgId })
    });
    const data = await res.json();
    document.getElementById("output").innerHTML =
        `ğŸ’° Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: ${data.balance}<br>ğŸ… Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: ${data.status}`;
}

async function leaderboard() {
    const res = await fetch("/api/leaderboard");
    const data = await res.json();
    let html = "<h3>ğŸ† Ğ¢Ğ¾Ğ¿ Ğ³Ñ€Ğ°Ğ²Ñ†Ñ–Ğ²</h3>";
    data.forEach((u, i) => {
        html += `${i+1}. ${u.nickname} - ${u.balance}ğŸ’°<br>`;
    });
    document.getElementById("output").innerHTML = html;
}
</script>

</body>
</html>
